"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.sanitize = void 0;
var sanitize = function sanitize() {
  var ignore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  return function (req, res, next) {
    var data = [];
    if (req.body) {
      data = Object.keys(req.body);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.body[data[i]] == 'string') req.body[data[i]] = req.sanitize(req.body[data[i]]).trim();
      }
    }
    if (req.params) {
      data = Object.keys(req.params);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.params[data[i]] == 'string') req.params[data[i]] = req.sanitize(req.params[data[i]]).trim();
      }
    }
    if (req.query) {
      data = Object.keys(req.query);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.query[data[i]] == 'string') req.query[data[i]] = req.sanitize(req.query[data[i]]).trim();
      }
    }
    next();
  };
};
exports.sanitize = sanitize;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzYW5pdGl6ZSIsImlnbm9yZSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInJlcSIsInJlcyIsIm5leHQiLCJkYXRhIiwiYm9keSIsIk9iamVjdCIsImtleXMiLCJpIiwiaW5kZXhPZiIsInRyaW0iLCJwYXJhbXMiLCJxdWVyeSIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS9zYW5pdGl6ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNhbml0aXplID0gZnVuY3Rpb24oaWdub3JlPVtdKXtcclxuICAgIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgIGlmKHJlcS5ib2R5KXtcclxuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5ib2R5KTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5ib2R5W2RhdGFbaV1dID09ICdzdHJpbmcnKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlcS5ib2R5W2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5ib2R5W2RhdGFbaV1dKS50cmltKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVxLnBhcmFtcyl7XHJcbiAgICAgICAgICAgIGRhdGEgPSBPYmplY3Qua2V5cyhyZXEucGFyYW1zKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5wYXJhbXNbZGF0YVtpXV0gPT0gJ3N0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnBhcmFtc1tkYXRhW2ldXSA9IHJlcS5zYW5pdGl6ZShyZXEucGFyYW1zW2RhdGFbaV1dKS50cmltKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVxLnF1ZXJ5KXtcclxuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5xdWVyeSk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGlmKGlnbm9yZS5pbmRleE9mKGRhdGFbaV0pID09IC0xICYmIHR5cGVvZiByZXEucXVlcnlbZGF0YVtpXV0gPT0gJ3N0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnF1ZXJ5W2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5xdWVyeVtkYXRhW2ldXSkudHJpbSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBcclxuICAgICAgICBuZXh0KCk7XHJcbiAgICB9XHJcbn07ICJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQU8sSUFBTUEsUUFBUSxHQUFHLFNBQVhBLFFBQVFBLENBQUEsRUFBc0I7RUFBQSxJQUFWQyxNQUFNLEdBQUFDLFNBQUEsQ0FBQUMsTUFBQSxRQUFBRCxTQUFBLFFBQUFFLFNBQUEsR0FBQUYsU0FBQSxNQUFDLEVBQUU7RUFDdEMsT0FBTyxVQUFDRyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxFQUFLO0lBQ3ZCLElBQUlDLElBQUksR0FBRyxFQUFFO0lBQ2IsSUFBR0gsR0FBRyxDQUFDSSxJQUFJLEVBQUM7TUFDUkQsSUFBSSxHQUFHRSxNQUFNLENBQUNDLElBQUksQ0FBQ04sR0FBRyxDQUFDSSxJQUFJLENBQUM7TUFDNUIsS0FBSSxJQUFJRyxDQUFDLEdBQUMsQ0FBQyxFQUFDQSxDQUFDLEdBQUNKLElBQUksQ0FBQ0wsTUFBTSxFQUFDUyxDQUFDLEVBQUUsRUFBQztRQUMxQixJQUFHWCxNQUFNLENBQUNZLE9BQU8sQ0FBQ0wsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLE9BQU9QLEdBQUcsQ0FBQ0ksSUFBSSxDQUFDRCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxFQUNwRVAsR0FBRyxDQUFDSSxJQUFJLENBQUNELElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsR0FBR1AsR0FBRyxDQUFDTCxRQUFRLENBQUNLLEdBQUcsQ0FBQ0ksSUFBSSxDQUFDRCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQ0UsSUFBSSxDQUFDLENBQUM7TUFDbEU7SUFDSjtJQUNBLElBQUdULEdBQUcsQ0FBQ1UsTUFBTSxFQUFDO01BQ1ZQLElBQUksR0FBR0UsTUFBTSxDQUFDQyxJQUFJLENBQUNOLEdBQUcsQ0FBQ1UsTUFBTSxDQUFDO01BQzlCLEtBQUksSUFBSUgsQ0FBQyxHQUFDLENBQUMsRUFBQ0EsQ0FBQyxHQUFDSixJQUFJLENBQUNMLE1BQU0sRUFBQ1MsQ0FBQyxFQUFFLEVBQUM7UUFDMUIsSUFBR1gsTUFBTSxDQUFDWSxPQUFPLENBQUNMLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPUCxHQUFHLENBQUNVLE1BQU0sQ0FBQ1AsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsRUFDdEVQLEdBQUcsQ0FBQ1UsTUFBTSxDQUFDUCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLEdBQUdQLEdBQUcsQ0FBQ0wsUUFBUSxDQUFDSyxHQUFHLENBQUNVLE1BQU0sQ0FBQ1AsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNFLElBQUksQ0FBQyxDQUFDO01BQ3RFO0lBQ0o7SUFDQSxJQUFHVCxHQUFHLENBQUNXLEtBQUssRUFBQztNQUNUUixJQUFJLEdBQUdFLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDTixHQUFHLENBQUNXLEtBQUssQ0FBQztNQUM3QixLQUFJLElBQUlKLENBQUMsR0FBQyxDQUFDLEVBQUNBLENBQUMsR0FBQ0osSUFBSSxDQUFDTCxNQUFNLEVBQUNTLENBQUMsRUFBRSxFQUFDO1FBQzFCLElBQUdYLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDTCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBT1AsR0FBRyxDQUFDVyxLQUFLLENBQUNSLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQ3JFUCxHQUFHLENBQUNXLEtBQUssQ0FBQ1IsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxHQUFHUCxHQUFHLENBQUNMLFFBQVEsQ0FBQ0ssR0FBRyxDQUFDVyxLQUFLLENBQUNSLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxJQUFJLENBQUMsQ0FBQztNQUNwRTtJQUNKO0lBQ0FQLElBQUksQ0FBQyxDQUFDO0VBQ1YsQ0FBQztBQUNMLENBQUM7QUFBQ1UsT0FBQSxDQUFBakIsUUFBQSxHQUFBQSxRQUFBIn0=